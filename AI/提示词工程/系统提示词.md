# 系统提示词 (System Prompt)

系统提示用于提供背景信息、操作规则、语气风格等说明。
- 良好的系统提示能显著提升LLM遵守指令的能力，有助于生成更稳定、规则化的输出。

## 基础示例

### 示例1
```markdown
你的回答应始终是一系列批判性思考问题，用于推动对话深入（不要提供问题的答案）。不得实际回答用户问题。
```

### 示例2
```markdown
要像一个三岁小孩那样写作。
```

## **设定角色（Role Prompting）**

### 定义
有时你需要明确提示 LLM 扮演某一特定角色（包括所有必要上下文），这被称为 **角色设定（Role Prompting）**。角色上下文越详细，效果越好。

为 LLM 设定角色能够在多个领域提升其表现，例如写作、编码、摘要生成等。这类似于人类有时在被告知“试着像一个___思考”时能更好地完成任务。角色设定还能改变 Claude 的输出风格、语气和表达方式。

> 注意：角色设定既可以出现在 system prompt 中，也可以包含在用户发出的消息中。
### 示例分析

#### 示例一：风格调节

- **System Prompt（未设定角色）**
  - Prompt: "你怎么看待滑板？"
  - 回应是客观、常规性的描述

- **System Prompt（设定角色为"猫"）**
  - Prompt 中加设定：You are a cat.
  - 响应变为带拟人化视角的幽默表达（提及追羽毛和晒太阳）

➡️ **技术启发**：通过赋予模型具体身份，可以诱导其生成符合该角色世界观的内容，显著影响生成风格与语境。

#### 示例二：**逻辑推理表现提升**

- **问题**：Jack 看 Anne，Anne 看 George，Jack 已婚，George 未婚，Anne 婚姻状态未知。问题是："是否存在已婚者在看未婚者？"

- **System Prompt（未设定角色）**
  -  可能未能得出正确结论，认为"无法确定"

- **System Prompt（设定为逻辑推理机器人）**
  - Prompt: You are a logic bot designed to answer complex logic problems.
  - LLM 成功识别蕴含逻辑，并正确得出："是的，存在已婚者在看未婚者。"

➡️ **技术启发**：当模型以"逻辑体"自居时，任务处理策略更偏向系统分析和演绎推理

### 机制
通过系统提示（System Prompt）或用户消息（User Message）中的明确指令，告诉模型应以哪种身份进行推理或表达。

## 工程启示

### 1. 角色设定 = 思维范式设定
类似于让人"像工程师一样思考"，角色设定帮助模型采用目标任务所需的推理路径。

### 2. 适用领域
- 写作风格（如：教授 vs. 学生 vs. 儿童）
- 技术任务（如：数学解题机器人、代码分析器）
- 多角度模拟（如问答对话、辩论）

### 3. 受众设定是增强维度
结合目标角色 + 目标受众（如"你是一只猫，在向滑板少年演讲"）可进一步精准输出语气与内容。

## 推荐实践

### 提示语句模板
```markdown
You are a [role] specialized in [domain]/你是一位专精于[领域]的[角色]
You are a [persona] talking to [audience]/你是一个[角色/身份]，正在与[受众]交谈
Think like a [professional/expert/agent]/像一个[专业人士/专家/代理人]那样思考
```

### 应用建议
- 在逻辑题、复杂写作、文风模仿中优先尝试角色提示，验证效果
## 将数据与指令分离
我们很多时候并不希望编写完整的提示词（prompt），而是希望有一个可被后续输入数据动态修改的提示词模板。这在你想让 LLM 每次执行相同任务，但输入数据每次不同的场景下尤其有用。

以下我们将逐步演示如何编写可替换的提示词模板，以及如何将用户输入替换进去。

提示词模板可以简化重复性任务。比如你构建了一个提示结构供第三方用户提交内容，只需要填写变量部分，无需了解完整提示词结构。这种结构在代码中也很常见。我们推荐使用双大括号（{{}}）格式来表示替换变量。
### 示例
扮演动物叫声生成器的角色
```markdonw
prompt: 我会告诉你一个动物的名字。请回复这个动物的叫声。{{ANIMAL}}
user: 牛
llm: 哞~
user: 蛙
llm: 呱呱
```
发送邮件
使用XML标签标明输入内容范围，避免指令和数据混淆问题。
```markdown
User: 以下是一组句子。请告诉我列表中的第二项。
- Each is about an animal, like rabbits.
<sentences>{{SENTENCES}}</sentences>
```

## 格式化输出
- XML
- JSON
## 提示词技巧
**逐步思考（Thinking Step by Step）**
> 如果有人在你刚醒来的时候立刻问你几个复杂的问题，并要求你马上作答，你会怎样？很可能表现不如给你时间先思考再回答。

**使用示例**（few-shot）

引导模型从「单一指令」到「基于少量示例」，强调了 prompt 中示例选择的重要性，以及输出格式一致性对自动评分系统的影响。

**避免幻觉生成**
LLM 有时会产生"幻觉"，做出不真实或无依据的陈述。我们可以使用多种技巧来减少这种情况。
- **允许Claude声明不知道答案**
- **要求Claude先收集证据再回答**
示例：河马体重问题
```markdown
如果你不确定答案，请直接说明。史上最重的河马是谁？
```
示例：
```markdown
请先提取相关证据，判断是否足以回答问题，再给出答案。2020年5月31日Matterport的订阅用户数是多少？
```
其他：
**温度参数(Temperature)调节**：


提示词
```markdown
User: 你是一位资深律师

以下是整理汇总的一些研究资料。请根据这些资料回答用户提出的法律问题。
<legal_research>
{{LEGAL_RESEARCH}}
</legal_research>

在引用法律研究内容时，请在句末使用方括号标注检索索引 ID，后跟一个句号。例如，正确的引用格式如下：

<examples>
  <example>
    此类犯罪的诉讼时效为10年。[3]。
  </example>
  <example>
    然而，当双方明确放弃时，该保护不适用。[5]。
  </example>
</examples>

写一个简明清晰的回答来回答这个问题：

<question>
{{QUESTION}}
</question>

它应该不超过几段。如果可能的话，应以一句话直接回答用户的问题。然而，如果在整理的研究资料中没有足够的信息来给出这样的答案，可以婉拒并写“抱歉，我手头没有足够的信息来回答这个问题。”

在回答之前，从研究中提取最相关的引用，并将其放入 <relevant_quotes> 标签中。

将你的两段回答放在 <answer> 标签中。

Assistant: <relevant_quotes>		
```

模版说明：
以下结构结合了多个提示工程元素，是构建复杂提示的良好起点。对于某些元素，顺序是重要的；对于其他元素，则影响不大。我们会在说明中指出顺序是否重要。但总的来说，遵循下列顺序即可构建出效果良好的提示。

| 提示词元素                   | 描述                                             | 示例                                                          | 顺序是否重要          |
| ----------------------- | ---------------------------------------------- | ----------------------------------------------------------- | --------------- |
| 1. `"User:"` 格式         | 使用 `CLAUDEMESSAGES()` 时，提示词必须以 `"User:"` 开头。   | `User:`                                                     | ✅ 必须在开头         |
| 2. 任务上下文                | 指明 Claude 的角色及总体目标。                            | `你将扮演由 AdAstra Careers 公司开发的 AI 职业教练 Joe，目标是为用户提供职业建议。`     | ✅ 建议放前面         |
| 3. 语气要求                 | 指明 Claude 应采用的语气风格。                            | `你应使用友好的客户服务语气与用户交流。`                                       | ❌ 视任务需求而定       |
| 4. 详细任务描述与规则            | 明确任务细节、操作规则，以及 Claude 不确定时的应对方式。               | `- 始终保持 Joe 的人设 ... - 若不确定如何回答，应说 "对不起，我没太理解您的问题，可以换种说法吗？"` | ✅ 建议逻辑清晰、术语明确定义 |
| 5. 示例                   | 提供一组或多组示例，使用 `<example></example>` 标签包裹。       | `<example>Customer: ...</example>`                          | ✅ 强烈推荐，例子越多越好   |
| 6. 输入数据                 | 若提示词需处理数据，使用 XML 标签如 `<history>`、`<question>`。 | `<history>{{HISTORY}}</history>`                            | ❌ 可选，顺序灵活       |
| 7. 即时任务说明               | 在提示词结尾明确当前要完成的具体任务。                            | `你应该如何回答用户的问题？`                                             | ✅ 建议放在提示词结尾     |
| 8. 思维过程提示（precognition） | 要求 Claude 在作答前先思考。                             | `在回答之前先思考一下你的答案。`                                           | ❌ 可选，但放在末尾效果最佳  |
| 9. 输出格式要求               | 指定响应格式，如使用 XML 标签。                             | `<response></response>`                                     | ❌ 可选，放末尾更佳      |
| 10. 预填 Claude 回应（可选）    | 用 `Assistant:` 开头预填一部分 Claude 的回应。             | `Assistant: [Joe] <response>`                               | ❌ 仅当需要预填时使用     |
复杂提示词
“财务行业中的提示词也可能因与法律提示词类似的原因而变得非常复杂。以下是一个财务用例的练习，其中 Claude 被用于分析税务信息并回答相关问题。就像法律服务示例一样，我们调整了部分元素的顺序，因为我们提出的提示词解决方案在不同的结构下更为合理（不过其他结构也是可行的）。

|**序号**|**提示词元素**|**描述**|**示例**|**备注**|
|---|---|---|---|---|
|1|“User:” 格式|使用 “User:” 开始你的 CLAUDEMESSAGES() 提示词。|User:|这是强制要求的！向 Claude 发送提示时，必须以此开头。|
|2|任务上下文|向 Claude 提供其应扮演的角色或你希望它完成的目标及总体任务。|You are a master tax accountant. Your task is to answer user questions using any provided reference documentation.|最好在提示词正文开头放置上下文信息。|
|3|语气上下文（可选）|如果语气对交互非常重要，请告知 Claude 应采用的语气。|视任务是否需要而定。|
|4|要处理的输入数据|如果 Claude 需要处理某些数据，请将其包含在相关 XML 标签中。可以包含多条数据，每条数据需用独立标签封装。|Here is the material you should use to answer the user’s question:{{TAX_CODE}}|当输入数据较长时，最好放在说明指令之前。|
|5|示例|提供至少一个理想响应的示例以供 Claude 模仿。用  标签包裹。可提供多个示例，并提供其上下文说明，每个示例使用独立标签封装。|Here is an example of how to respond:What defines a “qualified” employee?For purposes of this subsection—(A)In generalThe term “qualified employee” means any individual who—(i)is not an excluded employee, and(ii)agrees in the election made under this subsection to meet such requirements as are determined by the Secretary to be necessary to ensure that the withholding requirements of the corporation under chapter 24 with respect to the qualified stock are met.根据所提供的文档，“qualified employee”的定义为：1. 不是文档中定义的 “excluded employee”；2. 同意按照本小节所做的选择满足财政部长确定的所有要求，以确保公司就 qualified stock 遵守第24章下的预扣义务。|示例是使 Claude 行为符合预期的最有效工具之一。建议提供常见边界情况的示例。如果提示词使用了草稿区（scratchpad），可提供草稿格式示例。更多示例 = 更稳定结果，但响应时间与 Token 消耗也会增加。为便于阅读，此处仅提供一个示例。|
|6|详细任务描述和规则|进一步说明你希望 Claude 执行的具体任务及其必须遵循的规则。你也可以在此说明若 Claude 无法回答该如何处理。|First, gather quotes in  tags that are relevant to answering the user’s question. If there are no quotes, write “no relevant quotes found”.Then insert two paragraph breaks before answering the user question within  tags. Only answer the user’s question if you are confident that the quotes in  tags support your answer. If not, tell the user that you unfortunately do not have enough information to answer the user’s question.|建议将此部分展示给他人审阅，确保其逻辑清晰，词语无歧义。|
|7|当前任务说明|重新提醒 Claude 现在要执行的具体任务。此处也可加入如用户问题等变量。|Here is the user question: {{QUESTION}}|在提示词结尾提醒 Claude 其立即任务通常会提升效果，优于在开头处说明。也建议将用户问题放在接近提示词底部。|
|8|前置思考步骤（可选）|对于多步骤任务，建议提示 Claude 在回答前进行逐步思考。可显式说明“在回答之前，请先……”|可提升回答智能，但也增加响应长度与延迟。|
|9|输出格式（可选）|如有要求 Claude 的输出采用特定格式，请明确说明。|是否需要视任务而定。|
|10|Claude 回答预填（如需）|用于预填 Claude 的回答开头以引导其行为或方向。如需预填，**必须**包含“Assistant:”，且 **必须** 另起一行，否则将被视为“User:” 的一部分（我们会自动处理这一点）。|只有需要预填回答时才必须包含 “Assistant:”|
```markdown
"User: You are a master tax acountant. Your task is to answer user questions using any provided reference documentation.

Here is the material you should use to answer the user's question:
<docs>
{{TAX_CODE}}
</docs>

Here is an example of how to respond:
<example>
<question>
What defines a ""qualified"" employee?
</question>
<answer>
<quotes>For purposes of this subsection—
(A)In general
The term ""qualified employee"" means any individual who—
(i)is not an excluded employee, and
(ii)agrees in the election made under this subsection to meet such requirements as are determined by the Secretary to be necessary to ensure that the withholding requirements of the corporation under chapter 24 with respect to the qualified stock are met.</quotes>

<answer>According to the provided documentation, a ""qualified employee"" is defined as an individual who:

1. Is not an ""excluded employee"" as defined in the documentation.
2. Agrees to meet the requirements determined by the Secretary to ensure the corporation's withholding requirements under Chapter 24 are met with respect to the qualified stock.</answer>
</example>

First, gather quotes in <quotes></quotes> tags that are relevant to answering the user's question. If there are no quotes, write ""no relevant quotes found"".

Then insert two paragraph breaks before answering the user question within <answer></answer> tags. Only answer the user's question if you are confident that the quotes in <quotes></quotes> tags support your answer. If not, tell the user that you unfortunately do not have enough information to answer the user's question.

Here is the user question: {{QUESTION}}"		
		
```
我们将编写一个用于代码辅助与教学机器人的提示词，该机器人能够阅读代码，并在适当时提供引导性的修正建议。请在下方每个黄色框中填写提示词元素，这些元素需符合说明与前述复杂提示词示例中展示的风格

| 提示词元素                | 描述                                                                                                         | 示例                                                                                                                                                                                                                                                                                                                                                                                                                                              | 备注                                                                                                      |
| -------------------- | ---------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- |
| 1. "User:" 格式        | 使用 "User:" 开头你的 `CLAUDEMESSAGES()` 提示词。                                                                    | `User:`                                                                                                                                                                                                                                                                                                                                                                                                                                         | 这是强制性的！使用 `CLAUDEMESSAGES()` 提示 Claude 时，提示内容必须以此开头。                                                    |
| 2. 任务背景              | 为 Claude 提供其扮演的角色或希望其执行的目标与总体任务。                                                                           | `You are Codebot, a helpful AI assistant who finds issues with code and suggests possible improvements.`                                                                                                                                                                                                                                                                                                                                        | 最好在提示词前段添加背景信息。                                                                                         |
| 3. 语气背景（可选）          | 如果语气对交互重要，请说明 Claude 应使用的语气。                                                                               | `Act as a Socratic tutor who helps the user learn.`                                                                                                                                                                                                                                                                                                                                                                                             | 该项可视任务需求决定是否添加。                                                                                         |
| 4. 详细任务描述与规则         | 详细说明你希望 Claude 执行的具体任务及其必须遵循的规则。如果 Claude 不知道答案，也请为其提供回避选项。                                                | `You will be given some code from a user. Please do the following: 1. Identify any issues in the code. Put each issue inside separate <issues> tags. 2. Invite the user to write a revised version of the code to fix the issue.`                                                                                                                                                                                                               | 建议将此描述展示给他人查看，确保其逻辑清晰、无歧义。                                                                              |
| 5. 示例                | 至少提供一个理想响应的示例供 Claude 模仿。用 `<example></example>` XML 标签包裹。可提供多个示例，如此，请告知 Claude 示例所代表的含义，并用各自的 XML 标签包裹。   | `Here's an example: <example> <code>def calculate_circle_area(radius): return (3.14 * radius) ** 2</code> <issues> <issue>3.14 is being squared when it's actually only the radius that should be squared</issue> </issues> <response>That's almost right, but there's an issue related to order of operations. It may help to write out the formula for a circle and then look closely at the parentheses in your code.</response> </example>` | 示例是提升 Claude 行为一致性和可靠性的最有效方式之一。可包含边界情况示例。如使用工作区（scratchpad），建议附带其结构的示例。通常示例越多，效果越好（但响应时间和 token 消耗也更高）。 |
| 6. 待处理输入数据           | 使用 `{{CODE}}` 表示你希望 Claude 分析的代码。记得使用 XML 标签包裹。                                                            | `Here is the code you are to analyze: <code>{{CODE}}</code>`                                                                                                                                                                                                                                                                                                                                                                                    | 该元素不一定总是需要。顺序灵活。当输入代码较长时，建议将其置于提示前部。                                                                    |
| 7. 即时任务说明            | “提醒”Claude 或明确指出其立即需要完成的任务。此处也是引入用户变量（如 `{{VARIABLE_WORD}}`）的地方。                                           | `Find the relevant issues and write the Socratic tutor-style response. Do not give the user too much help! Instead, just give them guidance so they can find the correct solution themselves.`                                                                                                                                                                                                                                                  | 通常在提示词尾部添加即时任务指令效果最佳，比在开头更能提升 Claude 的回应质量。建议将用户查询接近提示底部放置。                                             |
| 8. 预思考（按步骤思考，可选）     | 对包含多个步骤的任务，可要求 Claude 在作答前逐步思考。你甚至可以明确说明“在作答前，请先进行思考”。                                                     | —                                                                                                                                                                                                                                                                                                                                                                                                                                               | 并非所有任务都需要。会提升回应智能性，但会增加响应时间。                                                                            |
| 9. 输出格式要求（可选）        | 若希望 Claude 按特定格式输出，请清晰指定输出格式。                                                                              | `Put each issue in <issue> tags and put your final response in <response> tags.`                                                                                                                                                                                                                                                                                                                                                                | 根据任务决定是否需要该项。                                                                                           |
| 10. 预填 Claude 回应（可选） | 用于预先填入 Claude 的回答起始部分，以引导其行为或响应内容。若需使用，**必须包含 `Assistant:`，并且必须换行单独写**，否则会被视为 `User:` 内容的一部分（我们已自动处理换行部分）。 | `Assistant:`                                                                                                                                                                                                                                                                                                                                                                                                                                    | 仅当希望预设 Claude 回答时才需要添加，否则可省略。                                                                           |
```markdown
"User: You are Codebot, a helpful AI assistant who finds issues with code and suggests possible improvements.

Act as a Socratic tutor who helps the user learn.

You will be given some code from a user. Please do the following:
1. Identify any issues in the code. Put each issue inside separate <issues> tags.
2. Invite the user to write a revised version of the code to fix the issue.


Here's an example:

<example>
<code>
def calculate_circle_area(radius):
    return (3.14 * radius) ** 2
</code>
<issues>
<issue>
3.14 is being squared when it's actually only the radius that should be squared>
</issue>
<response>
That's almost right, but there's an issue related to order of operations. It may help to write out the formula for a circle and then look closely at the parentheses in your code.
</response>
</example>

Here is the code you are to analyze:

<code>
{{CODE}}
</code>


Find the relevant issues and write the Socratic tutor-style response. Do not give the user too much help! Instead, just give them guidance so they can find the correct solution themselves.

Put each issue in <issue> tags and put your final response in <response> tags."		
		
		
```

## 小结
你学到的技巧——从逐步思考（step by step）、设定角色、使用示例，到清晰表达的全面能力——都可以被组合、重混和灵活应用于各种场景。

提示词工程（Prompt Engineering）是一个非常新兴的领域，请保持开放的心态。下一个伟大的提示词技巧，也许就由你来发现。”