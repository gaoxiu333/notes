# Docker 使用问题

# Docker 使用问题

## Mac 打包的镜像在 ubuntu 上无法使用

使用 buildx 指定环境打包

```bash
docker buildx build -t gaoxiu/rsshub:latest --platform=linux/amd64
```

## 查看 docker 日志

```bash
 docker logs --tail 50 --follow --timestamps rss_rsshub_1
```

## 查看 docker 运行状态

```bash
docker-compose ps -a
```

## docker-compose 执行报错

```bash
# 如果报 HTTPConnection.request() got an unexpected keyword argument 'chunked'pip list |grep request
pip install requests==2.28.0
```

## 运行

```json
docker run -p 3000:3000 my-node-app
```

## 日志

json-file 日志驱动是 Docker 的默认日志驱动，它会将每个容器的日志存储在宿主机的磁盘上，以 JSON 格式进行记录。具体日志文件的位置取决于宿主机的 Docker 配置和操作系统环境。

**默认存储位置**

在默认情况下，Docker 会将日志文件存储在宿主机上的 /var/lib/docker/containers/<container_id>/ 目录中。具体路径如下：

```python
/var/lib/docker/containers/<container_id>/<container_id>-json.log
```

- <container_id>：是容器的唯一标识符（container ID），你可以通过 docker ps 命令查看容器的 ID。
- <container_id>-json.log：日志文件的名称，以容器 ID 为前缀，后缀为 -json.log。

## 以非 root 用户管理Dokcer

参考：https://docs.docker.com/engine/install/linux-postinstall/

```python
# 查看用户组
less/cat etc/group
# 添加用户组
sudo groupadd docker
# 将当前用户添加到用户组
sudo usermod -aG docker $USER
# ？？
newgrp docker
# 验证
docker run hello-world
# 更改 .docker 权限
sudo chown "$USER":"$USER" /home/"$USER"/.docker -R
sudo chmod g+rwx "$HOME/.docker" -R

```

在 root 权限下创建用户

```python
# 创建
useradd -m gxdevops
passwd gxdevops
Robo.space123
# 添加用户组
usermod -aG docker gxdevops

# 验证用户
id gxdevops

# 验证docker权限
su - gxdevops # 切换用户
docker ps

```