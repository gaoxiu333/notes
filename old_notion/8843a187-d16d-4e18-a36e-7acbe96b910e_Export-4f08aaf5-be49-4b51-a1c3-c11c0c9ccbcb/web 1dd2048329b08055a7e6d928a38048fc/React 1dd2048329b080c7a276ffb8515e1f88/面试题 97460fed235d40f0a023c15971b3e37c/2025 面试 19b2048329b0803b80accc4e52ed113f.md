# 2025 面试

## React 相关

### 1. useEffect 与 useLayoutEffect 的区别是什么？

- 前者是在调度阶段的 `渲染阶段 diff阶段` ，放入调度任务里边，等待浏览器空闲时，通过 `channelMessage` 宏任务触发，是异步的
- 后者是在调度阶段，commit 阶段 同步执行，也就是浏览器绘制之前执行的。

### 2. useEffect 中通过 return 返回的函数，它的执行时机是在什么时候？

- 组件被卸载，或者依赖发生变化时执行这个返回函数。

### 3. React 18 中，ReactDOM.createRoot 和 ReactDOM.render 有什么区别

- 前者支持并发模式
- 后者是同步模式

### 4. React Hooks 中常见的闭包缺陷，通常是指在副作用的回调中去获取最新的 state 值，有什么方案可以解决

- 使用函数式更新。
- 使用 `useRef` 保存需要实时访问的值

### 5. Hooks 生命周期的执行顺序

- `useEffectLayout cleanups` → `useEffectLayout` → 浏览器绘制 → `useEffect cleanups` → `useEffect`
- `子组件 useLayoutEffect` → `useEffectLayout` → `子组件 useEffect` → `useEffect`
- `子组件 useLayoutEffect clean` → `useLayoutEffect clean` → `子组件 useLayoutEffect` → `useLayoutEffect` → `子组件 useEffect clean`  → `useEffect clean` → `子组件useEffect` …
- 大概这就是深度优先吧？

### 6. 如何理解 Fiber，以及Fiber 调度。它如何实现的可中断渲染和时间切片

- fiber 是 React 内部的最小工作单元
- hooks 组件通过 react.createElement 生成 React element对象，然后通过调度生成fiber树。
- fiber 节点存储了每个节点的当前的状态及如何执行方法
- alternate 指向上一次渲染的 Fiber，React 通过 current 和 workInProgress 进行**对比更新**，减少不必要的 DOM 操作（这个就是双缓存机制）
- 通过记录任务的优先级，来避免UI阻塞
    - 可中断渲染，也就是根据优先级来的，如果有高优先级的任务进来的，就会停掉正在执行的低优先级任务。

## Redux

1. Redux 第一原则是什么？本质是什么
    1. 单一数据源，整个应用的 state 存储在全局中唯一的 store 中
    2. 单向数据流
    3. 发布订阅
2. React 与 Redux 是如何实现桥接的
    1. 使用 `<Provider /> 注入到 React 组件。
    - **Provider 初始化**：在使用 `<Provider store={store}>` 包裹应用时，React-Redux 会创建一个全局的 `Subscription` 实例，绑定到 Store 的 `subscribe` 方法，用于监听状态变化。
    - **组件订阅**：当组件使用 `useSelector` 或 `connect` 订阅 Store 时，会在当前组件的 `Subscription` 上下文中创建一个订阅回调（嵌套的订阅树）。
    - 通知react更新时， 通过 `forceUpdate` 的方式触发重新渲染。
3. 桥接方式会带来什么问题？如何解决？
    1. 过度重新渲染，
    2. 耦合性过高，强依赖 Redux 
    3. 解决
        1. 使用 memo 缓存等方式
4. React 18 的并发模式为 Redux 带来了什么问题，react Redux 8 中又是如何解决的？
    1. 导致撕裂问题（只有并发模式下，外部数据源存在撕裂，但是原子化状态，不存在这个问题）
        1. 即：状态实际值和页面不一样
    2. redux 使用 React 最新的 api `**`useSyncExternalStore``** 

## JS 手写算法题

1. ~~链式调用，实现变量 u 满足以下条件：~~
    1. ~~支持链式调用，执行 setTimeout后，代码将会阻塞停滞，在指定时间后继续执行~~
    2. ~~如：`u.console(‘breakfast’).setTimeout(3000)~~

---