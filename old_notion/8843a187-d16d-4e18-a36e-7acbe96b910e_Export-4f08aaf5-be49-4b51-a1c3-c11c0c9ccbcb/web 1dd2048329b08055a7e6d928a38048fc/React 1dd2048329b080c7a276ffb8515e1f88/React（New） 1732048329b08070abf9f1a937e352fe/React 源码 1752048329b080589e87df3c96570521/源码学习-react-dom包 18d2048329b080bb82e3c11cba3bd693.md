# 源码学习-react-dom包

### **理解渲染器的具体实现**

将 React 组件渲染到实际的 DOM 或其他宿主环境中

- **目标**：
    - 学习如何将协调结果转化为实际的 DOM 操作。
- **关键点**：
    - DOM 节点的创建、更新、删除（如 `createInstance`/`commitUpdate`）。
    - 事件系统的实现（合成事件、事件委托）。
    - 服务端渲染（`react-dom/server`）和 hydration 逻辑。
- **为什么最后学**：
    - 渲染器是协调器的消费者，需先理解协调器输出的副作用指令。
- **理解**
    - 将协调器与浏览器DOM结合起来的渲染器。它使用react-reconciler提供的协调逻辑，并将结果渲染到DOM中，有createRoot、hydrateRoot等方法，这些方法会调用协调器的API，如createContainer、updateContainer，来创建根节点并启动渲染流程。同时，react-dom处理DOM操作，如创建元素、更新属性等，并将用户交互事件与React的事件系统集成

## API

**源码**

- 源码入口：[react/packages/react-dom/index.js](https://github.com/facebook/react/blob/v18.2.0/packages/react-dom/index.js)

**核心方法**

- 根节点管理
    - `createRoot` (React 18+ 并发模式入口)
    - `hydrateRoot` (React 18+ 服务端渲染激活入口)
    - `unmountComponentAtNode` (卸载组件)
- 传统模式渲染
    - `flushSync` 强制同步更新
    - `unstable_batchedUpdates` 批量更新处理
    - `unstable_flushControlled` 受控更新冲刷
- DOM 操作
    - `findDOMNode` 查找 DOM 节点（不推荐使用）
    - `createPortal` 创建跨 DOM 层级的 Portal