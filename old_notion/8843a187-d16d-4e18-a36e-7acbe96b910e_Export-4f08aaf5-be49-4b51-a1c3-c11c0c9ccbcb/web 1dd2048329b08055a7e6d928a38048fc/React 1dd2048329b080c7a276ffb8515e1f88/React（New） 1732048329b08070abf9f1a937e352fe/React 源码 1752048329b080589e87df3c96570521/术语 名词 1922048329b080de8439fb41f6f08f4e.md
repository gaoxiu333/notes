# 术语/名词

记录一些陌生的或者容易忘记的专有变量，这些变量名称可能是比较重要的。

- `workInProgress`
- `workLoopSync`
- `workLoop`
- `performUnitOfWork`
- `beginWork`
- `completeUnitOfWork`
- `scheduleUpdateOnFiber`
- `ensureRootIsScheduled`
- `performConcurrentWorkOnRoot`
- `beginWork`
- `completeWork`
- `commitRoot`
- `workInProgressRoot`
- `workInProgress`
- `performSyncWorkOnRoot`
- `performConcurrentWorkOnRoot`
- `renderRootConcurrent`

# React 源码核心变量/函数通俗解释

### 1. `workInProgress`

- **作用**：
相当于一个临时工，表示当前正在处理的 Fiber 节点。React 会同时维护两棵 Fiber 树（当前显示的和正在构建的），`workInProgress` 就是正在构建的新树中的当前节点。

---

### 2. `workLoopSync` & `workLoop`

- **作用**：
React 的工作循环。
    - `workLoopSync`是同步模式的工作循环（不可中断，快速处理完所有任务）。
    - `workLoop`是并发模式的工作循环（可中断，根据浏览器空闲时间分片处理）。

---

### 3. `performUnitOfWork`

- **作用**：
负责处理一个“工作单元”（即单个 Fiber 节点），调用 `beginWork` 开始处理，处理完返回下一个待处理的节点（DFS 深度优先遍历）。

---

### 4. `beginWork`

- **作用**：
针对当前 Fiber 节点的“开工阶段”：创建子节点、更新组件状态、计算新属性等。类似于装修前的设计图纸。

---

### 5. `completeUnitOfWork`

- **作用**：
完成当前 Fiber 节点的收尾工作（如生成 DOM、标记副作用等），并告诉 React 下一个该处理哪个节点（兄弟节点或父节点）。

---

### 6. `scheduleUpdateOnFiber`

- **作用**：
当状态发生变化时（比如你调用了 `setState`），这个函数会触发更新调度，告诉 React：“这里有个活要干，快来安排！”

---

### 7. `ensureRootIsScheduled`

- **作用**：
React 的调度器保安，确保根节点（Root）的更新任务被正确安排进调度器（比如让浏览器空闲时处理任务）。

---

### 8. `performConcurrentWorkOnRoot`

- **作用**：
在并发模式下，负责处理根节点对应的渲染任务。边干活边问浏览器：“我还能继续吗？” 如果时间不够就中断。

---

### 9. `completeWork`

- **作用**：
针对当前 Fiber 节点的“竣工阶段”：创建 DOM 节点、绑定事件、处理最终属性等。类似于装修的实际施工。

---

### 10. `commitRoot`

- **作用**：
把构建好的新 Fiber 树（`workInProgressRoot`）一口气提交到 DOM 上（更新界面）。这一步是同步的，不可中断。

---

### 11. `workInProgressRoot`

- **作用**：
指向当前正在构建的整棵新 Fiber 树的根节点（对比旧树的 `currentRoot`）。

---

### 12. 整体流程简化版

触发更新 → scheduleUpdateOnFiber → 安排调度 → workLoop → performUnitOfWork → beginWork → completeWork → 循环直到整棵树处理完 → commitRoot → 更新界面