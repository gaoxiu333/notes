---
title: ä¾èµ–ç®¡ç†ä¸åŒ…ç®¡ç†æŒ‡å—
jd_id: J10-20250528-1401
created: 2025-05-28 14:01
updated: 2025-06-02 19:59
type: guide
status: active
tags: [topic/dependency, topic/pnpm, topic/management, action/guide]
---

# ğŸ“¦ ä¾èµ–ç®¡ç†æŒ‡å—

> [!abstract] æ¦‚è¿°
> æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»äº†åœ¨ React æŠ€æœ¯æ ˆé¡¹ç›®ä¸­ä½¿ç”¨ pnpm è¿›è¡Œä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬å·¥å…·ä½¿ç”¨ã€ç‰ˆæœ¬æ§åˆ¶å’Œç¯å¢ƒç®¡ç†ç­‰å…³é”®å†…å®¹ã€‚

## æ ¸å¿ƒå·¥å…·

> [!info] æ¨èå·¥å…·
>
> - **knip** - æ£€æµ‹æœªä½¿ç”¨çš„åŒ…æˆ–æ–‡ä»¶
> - **syncpack** - æŒä¾èµ–é¡¹ç‰ˆæœ¬åŒæ­¥
> - ä¿®å‰ªæœªä½¿ç”¨çš„ä¾èµ–é¡¹

---

## æ“ä½œæŒ‡å—

### æ·»åŠ /åˆ é™¤/æ›´æ–°ä¾èµ–

#### å­åº”ç”¨å®‰è£…åŒ…
```bash
# æ–¹å¼ä¸€ï¼šè¿›å…¥ç‰¹å®šåŒ…ç›®å½•
cd apps/nextjs-app
pnpm add <package-name>

# æ–¹å¼äºŒï¼šåœ¨æ ¹ç›®å½•ä½¿ç”¨ --filterï¼ˆæ¨èï¼‰
pnpm add <package-name> --filter nextjs-app

#### æ ¹å·¥ä½œåŒºå®‰è£…åŒ…


# æ·»åŠ å¼€å‘ä¾èµ–åˆ°æ ¹å·¥ä½œåŒº
pnpm add <package-name> -D -w # -w æˆ– --workspace-root
```

### å‡çº§ä¾èµ–

```bash
pnpm up --recursive typescript@latest ?
# å‡çº§æ‰€æœ‰åŒ…ä¸­çš„ç‰¹å®šä¾èµ–
pnpm up -r <package-name>

# å‡çº§æ‰€æœ‰åŒ…ä¸­çš„æ‰€æœ‰ä¾èµ–åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆè°¨æ…æ“ä½œï¼‰
pnpm up -r --latest

# é¡ºä¾¿æ£€æŸ¥ç‰ˆæœ¬ä¸€è‡´æ€§
pnpx syncpack lint --dependency-types prod,dev

# ä¿®å¤ç‰ˆæœ¬
npx syncpack fix --dependency-types prod,dev

# æ ¼å¼åŒ– package.json
npx syncpack format
```

---

## ç‰ˆæœ¬ä¸€è‡´æ€§ç®¡ç†

> [!important] å…³é”®å®è·µ
>
> 1. **å®šæœŸæ£€æŸ¥**: è¿è¡Œ `syncpack lint` æ£€æŸ¥ç‰ˆæœ¬ä¸ä¸€è‡´é—®é¢˜
> 2. **è‡ªåŠ¨ä¿®å¤**: è¿è¡Œ `syncpack fix` è‡ªåŠ¨ä¿®å¤ç‰ˆæœ¬å†²çª
> 3. **å¼ºåˆ¶è¦†ç›–**: å¯¹äºæ ¸å¿ƒåº“ï¼ˆReact, Next.js ç­‰ï¼‰ï¼Œå¯åœ¨æ ¹ `package.json` çš„ `pnpm.overrides` å­—æ®µä¸­å¼ºåˆ¶æŒ‡å®šç‰ˆæœ¬

### å¤„ç†å†…éƒ¨åŒ…ä¾èµ–

> [!note] è‡ªåŠ¨é“¾æ¥é…ç½®
> ç”±äºé…ç½®äº† `link-workspace-packages=true` å’Œ `save-workspace-protocol=true`ï¼Œpnpm ä¼šè‡ªåŠ¨å¤„ç†æœ¬åœ°é“¾æ¥ã€‚
>
> **ä½¿ç”¨æ–¹æ³•**ï¼šç›´æ¥åœ¨ç›®æ ‡åº”ç”¨çš„ `package.json` ä¸­æ·»åŠ ï¼š
>
> ```json
> "@repo/ui": "workspace:*"
> ```

---

## ä»£ç è´¨é‡ç®¡ç†

> [!success] è‡ªåŠ¨åŒ–æ£€æŸ¥
>
> - **Lint æ£€æŸ¥**: é€šè¿‡ Turborepo åœ¨æ‰€æœ‰ç›¸å…³åŒ…ä¸­æ‰§è¡Œ
> - **ç±»å‹æ£€æŸ¥**: `check-types` è„šæœ¬ç¡®ä¿ç±»å‹å®‰å…¨
> - **æäº¤å‰æ£€æŸ¥**: Husky `pre-commit` é’©å­ç¡®ä¿ä»£ç è§„èŒƒ

---

## ç¯å¢ƒç®¡ç†

### Node.js ç‰ˆæœ¬æ§åˆ¶

> [!gear] ç‰ˆæœ¬è¦æ±‚
>
> - **`.nvmrc`**: å»ºè®®ä½¿ç”¨ NVM ç®¡ç† Node.js ç‰ˆæœ¬ï¼Œç¡®ä¿å¼€å‘ç¯å¢ƒä¸€è‡´æ€§
> - **ç‰ˆæœ¬é™åˆ¶**: `"engines": { "node": ">=18" }` é…åˆ `engine-strict=true` å¼ºåˆ¶ç‰ˆæœ¬è¦æ±‚

### é…ç½®æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶           | ä½œç”¨          | è¯´æ˜                             |
| -------------- | ------------- | -------------------------------- |
| `.nvmrc`       | Node ç‰ˆæœ¬é”å®š | ä¿è¯å›¢é˜Ÿå¼€å‘ç¯å¢ƒä¸€è‡´             |
| `.npmrc`       | npm é…ç½®      | åŒ…å« `engine-strict=true` ç­‰é…ç½® |
| `package.json` | é¡¹ç›®é…ç½®      | å®šä¹‰å¼•æ“ç‰ˆæœ¬è¦æ±‚                 |


### å¼‚å¸¸å¤„ç†

æ¸…ç©ºç¼“å­˜é‡æ–°å®‰è£…ä¾èµ–
```bash
pnpm store prune
rm -rf node_modules
pnpm install
```